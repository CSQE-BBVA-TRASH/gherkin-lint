<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: max-scenarios-per-file.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: max-scenarios-per-file.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
* @module rules/max-scenarios-per-file
**/
const _ = require('lodash');


/** The name of the rule
* @member {string} name
**/
const name = 'max-scenarios-per-file';

/** 
The max-scenarios-per-file rule supports the following configuration options:
&lt;br>- maxScenarios {int} - the maximum scenarios per file after which the rule fails. Defaults to `10`.
&lt;br>- countOutlineExamples {boolean} - whether to count every example row for a Scenario Outline, 
as opposed to just 1 for the whole block. Defaults to `true`.

@example &lt;caption>The rule configuration should look like this&lt;/caption> 
{
  "max-scenarios-per-file": ["on", {"maxScenarios": 10, "countOutlineExamples": true}]
}
@member {Object} availableConfigs
**/
const availableConfigs = {
  'maxScenarios': 10,
  'countOutlineExamples': true
};


/**
@function run
@description runs the rule's logic against the provide feature file/object
@alias module:run
@param feature       {Gerkin.Feature} - A Gerkin.Feature object
@param unused        {}               - Unused parameter, exists to conform to the rule run method signature
@param configuration {Object}         - The rule configuration whose format should match `availableConfigs`
@returns             {Array}          - The detected errors
**/
function run(feature, unused, config) {
  if (!feature) {
    return [];
  }

  let errors = [];
  const mergedConfiguration = _.merge({}, availableConfigs, config);
  const maxScenarios = mergedConfiguration.maxScenarios;
  let count = feature.children.length;

  feature.children.forEach(child => {
    if (child.background) {
      count = count - 1;
    } else if (child.scenario.examples.length  &amp;&amp; mergedConfiguration.countOutlineExamples) {
      count = count - 1;
      child.scenario.examples.forEach(example => {
        if (example.tableBody) {
          count = count + example.tableBody.length;
        }
      });
    }
  });

  if (count > maxScenarios) {
    errors.push({
      message: 'Number of scenarios exceeds maximum: ' + count + '/' + maxScenarios,
      rule: name,
      line: 0
    });
  }

  return errors;
}

module.exports = {
  name,
  run,
  availableConfigs,
};
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-rules_allowed-tags.html">rules/allowed-tags</a></li><li><a href="module-rules_indentation.html">rules/indentation</a></li><li><a href="module-rules_max-scenarios-per-file.html">rules/max-scenarios-per-file</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.3</a> on Sun Apr 05 2020 01:46:58 GMT+0300 (Eastern European Summer Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
